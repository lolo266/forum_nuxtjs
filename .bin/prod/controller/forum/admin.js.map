{"version":3,"sources":["../../../../server/controller/forum/admin.js"],"names":["CreateChild","req","res","auth","Server","Msg","user","offline","category","title","vip","body","newChild","DB","ForumChilds","save","json","err","child","e","status","toString","DeleteChild","deleteOne","_id","ForumTopics","deleteMany","ForumPosts","CreateCategory","newCategory","ForumCategorys","DeleteCategory"],"mappings":"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","file":"admin.js","sourcesContent":["export const CreateChild = async (req, res) => {\r\n    try {\r\n        if(!req.auth) throw Server.Msg.user.offline;\r\n        let { category, title, vip } = req.body;\r\n        if(req.body.title == '' || req.body.category == '') throw 'Dữ liệu đầu vào không đủ';\r\n\r\n        let newChild = new Server.DB.ForumChilds({\r\n            title: title,\r\n            category: category,\r\n            vip: (vip && typeof vip === 'boolean') ? vip : false,\r\n        });\r\n        await newChild.save();\r\n\r\n        res.json({err: false, child: newChild});\r\n    }\r\n    catch(e){\r\n        res.json({err: true, status: e.toString()})\r\n    }\r\n}\r\n\r\nexport const DeleteChild = async (req, res) => {\r\n    try {\r\n        if(!req.auth) throw Server.Msg.user.offline;\r\n        if(!req.body.child || !req.body.category) throw 'Dữ liệu đầu vào không đủ';\r\n\r\n        await Server.DB.ForumChilds.deleteOne({\r\n            _id: req.body.child,\r\n        });\r\n\r\n        await Server.DB.ForumTopics.deleteMany({\r\n            child: req.body.child,\r\n        }); \r\n        await Server.DB.ForumPosts.deleteMany({\r\n            child: req.body.child,\r\n        });\r\n        \r\n        res.json({err: false})\r\n    }\r\n    catch(e){\r\n        res.json({err: true, status: e.toString()})\r\n    }\r\n}\r\n\r\nexport const CreateCategory = async (req, res) => {\r\n    try {\r\n        if(!req.auth) throw Server.Msg.user.offline;\r\n        if(!req.body.title) throw 'Dữ liệu đầu vào không đủ';\r\n\r\n        let newCategory = new Server.DB.ForumCategorys({\r\n            title: req.body.title,\r\n        });\r\n\r\n        await newCategory.save();\r\n\r\n        res.json({err: false, category: newCategory});\r\n    }\r\n    catch(e){\r\n        res.json({err: true, status: e.toString()})\r\n    }\r\n}\r\n\r\nexport const DeleteCategory = async (req, res) => {\r\n    try {\r\n        if(!req.auth) throw Server.Msg.user.offline;\r\n        if(req.body.category == '') throw 'Dữ liệu đầu vào không đủ';\r\n\r\n        await Server.DB.ForumCategorys.deleteOne({\r\n            _id: req.body.category,\r\n        });\r\n        await Server.DB.ForumChilds.deleteMany({\r\n            category: req.body.category,\r\n        });\r\n\r\n        await Server.DB.ForumTopics.deleteMany({\r\n            category: req.body.category,\r\n        }); \r\n        await Server.DB.ForumPosts.deleteMany({\r\n            category: req.body.category,\r\n        });\r\n\r\n        res.json({err: false});\r\n    }\r\n    catch(e){\r\n        res.json({err: true, status: e.toString()})\r\n    }\r\n}"]}