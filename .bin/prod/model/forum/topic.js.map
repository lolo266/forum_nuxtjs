{"version":3,"sources":["../../../../server/model/forum/topic.js"],"names":["StringLib","Schema","mongoose","Topics","category","type","Types","ObjectId","ref","child","creator","title","String","content","date","Date","default","now","link","Case","images","id","setting","noftication","Boolean","post","lock","update","toJSON","virtuals","virtual","localField","foreignField","count","index","module","exports"],"mappings":";;AAAA;;;;AACA;;IAAYA,S;;;;;;AAEZ,MAAMC,SAASC,mBAASD,MAAxB;AACA,MAAME,SAAS,IAAIF,MAAJ,CAAW;AACtBG,cAAU,EAAEC,MAAMJ,OAAOK,KAAP,CAAaC,QAArB,EAA+BC,KAAK,gBAApC,EADY;AAEtBC,WAAO,EAAEJ,MAAMJ,OAAOK,KAAP,CAAaC,QAArB,EAA+BC,KAAK,aAApC,EAFe;AAGtB;AACAE,aAAS,EAAEL,MAAMJ,OAAOK,KAAP,CAAaC,QAArB,EAA+BC,KAAK,OAApC,EAJa;AAKtBG,WAAO,EAAEN,MAAMO,MAAR,EALe;AAMtBC,aAAS,EAAER,MAAMO,MAAR,EANa;AAOtBE,UAAM,EAAET,MAAMU,IAAR,EAAcC,SAASD,KAAKE,GAA5B,EAPgB;AAQtBC,UAAM,EAAEb,MAAMO,MAAR,EAAiBI,SAAS,YAAU;AACtC,gBAAG,KAAKL,KAAR,EAAe,OAAOX,UAAUmB,IAAV,CAAe,KAAKR,KAApB,EAA2B,GAA3B,CAAP;AACf,mBAAO,IAAP;AACH,SAHK,EARgB;AAYtBS,YAAQ,CAAC;AACLC,YAAI,EAAChB,MAAMO,MAAP,EADC;AAELP,cAAM,EAACA,MAAMO,MAAP;AAFD,KAAD,CAZc;AAgBtB;AACAU,aAAS;AACLC,qBAAa,EAAElB,MAAOmB,OAAT,EAAkBR,SAAS,KAA3B,EADR;AAELS,cAAM,EAAEpB,MAAOmB,OAAT,EAAkBR,SAAS,KAA3B;AAFD,KAjBa;AAqBtBU,UAAM,EAAErB,MAAOmB,OAAT,EAAkBR,SAAS,KAA3B,EArBgB;AAsBtBW,YAAQ,EAAEtB,MAAMU,IAAR,EAAcC,SAASD,KAAKE,GAA5B;AAtBc,CAAX,EAuBZ,EAAEW,QAAQ,EAAEC,UAAU,IAAZ,EAAV,EAvBY,CAAf;;AAyBA;AACA1B,OAAO2B,OAAP,CAAe,OAAf,EAAwB;AACpBtB,SAAK,YADe;AAEpBuB,gBAAY,KAFQ;AAGpBC,kBAAc;AAHM,CAAxB;;AAMA7B,OAAO2B,OAAP,CAAe,UAAf,EAA2B;AACvBtB,SAAK,YADkB;AAEvBuB,gBAAY,KAFW;AAGvBC,kBAAc,OAHS;AAIvBC,WAAO;AAJgB,CAA3B;;AAOA;AACA9B,OAAO+B,KAAP,CAAa,EAAEhB,MAAM,MAAR,EAAb;;AAEAiB,OAAOC,OAAP,GAAiBjC,MAAjB","file":"topic.js","sourcesContent":["import mongoose from 'mongoose';\r\nimport * as StringLib from '../../plugins/stringcase' ;\r\n\r\nconst Schema = mongoose.Schema;\r\nconst Topics = new Schema({\r\n    category: { type: Schema.Types.ObjectId, ref: 'ForumCategorys' },\r\n    child: { type: Schema.Types.ObjectId, ref: 'ForumChilds' },\r\n    //Main\r\n    creator: { type: Schema.Types.ObjectId, ref: 'Users' },\r\n    title: { type: String },\r\n    content: { type: String },\r\n    date: { type: Date, default: Date.now },\r\n    link: { type: String , default: function(){\r\n        if(this.title) return StringLib.Case(this.title, '-');\r\n        return null;\r\n    }},\r\n    images: [{\r\n        id: {type: String},\r\n        type: {type: String}\r\n    }],\r\n    //Setting\r\n    setting: {\r\n        noftication: { type : Boolean, default: false },\r\n        post: { type : Boolean, default: false }\r\n    },\r\n    lock: { type : Boolean, default: false },\r\n    update: { type: Date, default: Date.now }\r\n}, { toJSON: { virtuals: true } });\r\n\r\n//Virtual\r\nTopics.virtual('posts', {\r\n    ref: 'ForumPosts',\r\n    localField: '_id',\r\n    foreignField: 'topic',\r\n});\r\n\r\nTopics.virtual('numPosts', {\r\n    ref: 'ForumPosts',\r\n    localField: '_id',\r\n    foreignField: 'topic',\r\n    count: true\r\n});\r\n\r\n//Index\r\nTopics.index({ link: 'text' });\r\n\r\nmodule.exports = Topics;\r\n"]}